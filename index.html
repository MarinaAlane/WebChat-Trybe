<!DOCTYPE html>
<html>

<head>
    <title>Socket IO - Trybe</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: sans-serif;
            box-sizing: border-box;
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/3.0.4/socket.io.js"></script>
  
</head>
<body>
    <ul id="messages"></ul>

    <form action="" id="form">
        <input id="nicknameInput"/>
        <input id="mensagemInput" autocomplete="off" />
        <button>Enviar</button>
    </form>

    <script>
       const socket = io();
       const form = document.querySelector('#form');
       const inputMessage = document.querySelector('#mensagemInput')
       const nickname = document.querySelector('#nicknameInput');
       form.addEventListener('submit', (e) => {
           e.preventDefault();
           if(inputMessage.value) {
             const data = {
                 chatMessage: inputMessage.value,
                 nickname: nickname.value
             }
             console.log(data);
                socket.emit('message', data);
                inputMessage.value = '';
              }  
         });

            socket.on('message', (message) => {
                const ul = document.querySelector('#messages');
                console.log(message);
                const { dataAtual, horaAtual, nickname, chatMessage } = message;
                const li = document.createElement('li');
                li.textContent = message;
                ul.appendChild(li);
            });         

    </script>

</body>

</html>
